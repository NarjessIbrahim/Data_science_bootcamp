<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<!-- Styles -->
<style>
#chartdiv {
  width: 100%;
  height: 500px;
}
</style>

<!-- Resources -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/wc.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

<!-- Chart code -->
<script>
am5.ready(function() {

// Create root element
var root = am5.Root.new("chartdiv");

// Set themes
root.setThemes([
  am5themes_Animated.new(root)
]);

// Add series
var series = root.container.children.push(am5wc.WordCloud.new(root, {
  maxCount: 100,
  minWordLength: 2,
  minFontSize: am5.percent(6),
  maxFontSize: am5.percent(8),
  angles: [0]
}));

// Configure labels
series.labels.template.setAll({
  paddingTop: 5,
  paddingBottom: 5,
  paddingLeft: 5,
  paddingRight: 5,
  fontFamily: "Courier New"
});

// Use a custom function to set the color based on the category
series.labels.template.adapters.add("fill", function(fill, target) {
  var dataItem = target.dataItem;
  if (dataItem && dataItem.get("category")) {
    // Black color for article titles
    return am5.color(0x000000);
  }
  return fill;
});

// Function to update the chart with data from the API
function updateChart(author) {
  var url = "http://127.0.0.1:5000/articles_by_author/" + encodeURIComponent(author);

  fetch(url)
    .then(response => response.json())
    .then(data => {
      // Process data and populate the chart
      var chartData = data.map(item => ({
        category: item.title,
        value: 1 // Set to 1 or another value based on your data's relevance
      }));
      series.data.setAll(chartData);

      // Add title to the chart with the author's name
      root.container.children.push(am5.Label.new(root, {
        text: "Articles by " + author,
        fontSize: 20,
        x: am5.percent(50),
        centerX: am5.percent(50),
        dy: -30
      }));
    })
    .catch(error => console.error('Error fetching data:', error));
}

// Call updateChart with the desired author
var author = "هدى رزق"; // Replace with the desired author or make dynamic
updateChart(author);

}); // end am5.ready()
</script>

<!-- HTML -->
<div id="chartdiv"></div>

</body>
</html>